---
layout: layouts/base.njk
---

<div class="product-page">
  <div class="container">
    <nav aria-label="Breadcrumb" class="breadcrumb">
      <ol>
        <li><a href="/">Inicio</a></li>
        <li><a href="/shop/">Tienda</a></li>
        <li><a href="/shop/{{ category }}/">{{ category | title }}</a></li>
        <li aria-current="page">{{ title }}</li>
      </ol>
    </nav>
    
    <div class="product-details">
      <div class="product-gallery">
        {% if images and images.length > 0 %}
        <div class="product-gallery__main">
          <img src="{{ images[0] }}" 
               alt="{{ title }}" 
               id="main-product-image"
               width="600" 
               height="600">
        </div>
        
        {% if images.length > 1 %}
        <div class="product-gallery__thumbs">
          {% for image in images %}
          <button class="thumb {% if loop.first %}active{% endif %}" 
                  data-image="{{ image }}">
            <img src="{{ image }}" alt="{{ title }}" width="80" height="80">
          </button>
          {% endfor %}
        </div>
        {% endif %}
        {% endif %}
      </div>
      
      <div class="product-info">
        <div class="product-info__header">
          <h1 class="product-title">{{ title }}</h1>
          
          <div class="product-rating">
            <div class="stars" data-rating="4.5">
              <span class="stars-fill" style="width: 90%"></span>
            </div>
            <span class="rating-text">({{ reviews or 0 }} reseñas)</span>
          </div>
        </div>
        
        <div class="product-price">
          {% if originalPrice and originalPrice > price %}
          <span class="price-original">{{ originalPrice | formatPrice }}</span>
          <span class="price-discount">
            -{{ (((originalPrice - price) / originalPrice) * 100) | round }}%
          </span>
          {% endif %}
          <span class="price-current">{{ price | formatPrice }}</span>
        </div>
        
        <div class="product-description">
          <p>{{ description }}</p>
        </div>
        
        {% if specifications %}
        <div class="product-specs">
          <h3>Especificaciones</h3>
          <dl class="specs-list">
            {% for spec in specifications %}
            <dt>{{ spec.name }}:</dt>
            <dd>{{ spec.value }}</dd>
            {% endfor %}
          </dl>
        </div>
        {% endif %}
        
        <div class="product-actions">
          {% if stock > 0 %}
          <div class="quantity-selector">
            <label for="quantity">Cantidad:</label>
            <div class="quantity-input">
              <button type="button" class="quantity-btn" data-action="decrease">−</button>
              <input type="number" id="quantity" value="1" min="1" max="{{ stock }}">
              <button type="button" class="quantity-btn" data-action="increase">+</button>
            </div>
          </div>
          
          <button class="btn btn-primary btn-large add-to-cart-btn" 
                  data-add-to-cart
                  data-product='{{ {
                    id: sku,
                    name: title,
                    price: price,
                    image: images[0] if images else "/assets/images/placeholder-product.jpg"
                  } | dump }}'>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.1 5.4M7 13v6a2 2 0 002 2h6a2 2 0 002-2v-6"/>
            </svg>
            Añadir al carrito
          </button>
          
          <button class="btn btn-secondary btn-large wishlist-btn">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
            </svg>
            Añadir a favoritos
          </button>
          
          <p class="stock-info">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M9 12l2 2 4-4"></path>
              <path d="M21 12c-1 0-3-1-3-3s2-3 3-3 3 1 3 3-2 3-3 3"></path>
              <path d="M3 12c1 0 3-1 3-3s-2-3-3-3-3 1-3 3 2 3 3 3"></path>
            </svg>
            {{ stock }} unidades disponibles
          </p>
          {% else %}
          <button class="btn btn-secondary btn-large" disabled>
            Producto agotado
          </button>
          <p class="stock-info stock-info--out">
            Este producto no está disponible actualmente
          </p>
          {% endif %}
        </div>
        
        <div class="product-features">
          <div class="feature">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
            </svg>
            <span>Envío gratuito en pedidos +€{{ site.ecommerce.freeShippingThreshold }}</span>
          </div>
          
          <div class="feature">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M9 12l2 2 4-4"></path>
            </svg>
            <span>{{ site.ecommerce.returnPeriod }} días para devoluciones</span>
          </div>
          
          <div class="feature">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <rect x="3" y="5" width="18" height="14" rx="2"></rect>
              <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
            <span>Pago 100% seguro</span>
          </div>
        </div>
      </div>
    </div>
    
    <div class="product-tabs">
      <nav class="tabs-nav" role="tablist">
        <button class="tab-btn active" 
                role="tab" 
                aria-selected="true" 
                aria-controls="description-panel">
          Descripción
        </button>
        <button class="tab-btn" 
                role="tab" 
                aria-selected="false" 
                aria-controls="specs-panel">
          Especificaciones
        </button>
        <button class="tab-btn" 
                role="tab" 
                aria-selected="false" 
                aria-controls="reviews-panel">
          Reseñas
        </button>
        <button class="tab-btn" 
                role="tab" 
                aria-selected="false" 
                aria-controls="shipping-panel">
          Envío
        </button>
      </nav>
      
      <div class="tabs-content">
        <div class="tab-panel active" 
             id="description-panel" 
             role="tabpanel">
          <div class="prose">
            {{ content | safe }}
          </div>
        </div>
        
        <div class="tab-panel" 
             id="specs-panel" 
             role="tabpanel">
          {% if specifications %}
          <table class="specs-table">
            {% for spec in specifications %}
            <tr>
              <td>{{ spec.name }}</td>
              <td>{{ spec.value }}</td>
            </tr>
            {% endfor %}
          </table>
          {% else %}
          <p>No hay especificaciones disponibles.</p>
          {% endif %}
        </div>
        
        <div class="tab-panel" 
             id="reviews-panel" 
             role="tabpanel">
          <div class="reviews-section">
            <p>Las reseñas aparecerán aquí una vez implementado el sistema de reseñas.</p>
          </div>
        </div>
        
        <div class="tab-panel" 
             id="shipping-panel" 
             role="tabpanel">
          <div class="shipping-info">
            <h3>Información de envío</h3>
            <ul>
              <li>Envío gratuito en pedidos superiores a €{{ site.ecommerce.freeShippingThreshold }}</li>
              <li>Envío estándar: €{{ site.ecommerce.shippingCost }} (3-5 días laborables)</li>
              <li>Envío express: €{{ site.ecommerce.expressShippingCost }} (1-2 días laborables)</li>
              <li>{{ site.ecommerce.returnPeriod }} días para devoluciones gratuitas</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Product",
  "name": "{{ title }}",
  "description": "{{ description }}",
  "image": {{ images | dump | safe }},
  "sku": "{{ sku }}",
  "brand": {
    "@type": "Brand",
    "name": "{{ site.title }}"
  },
  "offers": {
    "@type": "Offer",
    "price": "{{ price }}",
    "priceCurrency": "{{ site.ecommerce.currency }}",
    "availability": "{% if stock > 0 %}https://schema.org/InStock{% else %}https://schema.org/OutOfStock{% endif %}",
    "seller": {
      "@type": "Organization",
      "name": "{{ site.title }}"
    }
  }
}
</script>